<% const reviewProgress = {}; %>
<% include partial/review-progress %>
<% 
const oneDay = 24 * 60 * 60 * 1000;
const now = new Date().getTime();
reviewProgress.next24hourReviews = 0;
let firstReview = null;
for(const id in states){
	if(!firstReview || states[id].due < firstReview.due){
		firstReview = states[id];
	}

	if(states[id].due < now + oneDay) reviewProgress.next24hourReviews++;
}

reviewProgress.timeString = "a long time";  
if(firstReview == null){
	reviewProgress.timeString = "no cards have been made"
} else {
	const time = firstReview.due;
	const seconds = (time - new Date().getTime()) / 1000;
	const minutes = (time - new Date().getTime()) / (1000 * 60);
	const hours = (time - new Date().getTime()) / (1000 * 60 * 60);
	if(seconds < 60) {
		reviewProgress.timeString = Math.floor(seconds);
		reviewProgress.timeString += "秒";
	} else if(minutes < 60) {
		reviewProgress.timeString = Math.floor(minutes);
		reviewProgress.timeString += "分";
	} else if(hours < 24) {
		reviewProgress.timeString =  Math.floor(hours);
		reviewProgress.timeString += "時間";
	} else {
		reviewProgress.timeString = Math.floor(hours / 24);
		reviewProgress.timeString += "日";
	}
}

let iconDir = 'estelle';
if (typeof icon != 'undefined' && icon) {
	iconDir = icon;
} 
%>
<%- include('partial/card-page', { content: include('partial/no-reviews-content', {reviewProgress: reviewProgress}), title: `${reviewProgress.statesCreatedToday}新枚` }) %>